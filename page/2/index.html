<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> 我的日常生活分享</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/cdn/fav.png" />
       
<link rel="stylesheet" href="/dist/main.css">

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
      />
      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
       
 

      <!-- mermaid -->
      
      <script data-ad-client="ca-pub-2856060118135787" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <link rel="alternate" href="/atom.xml" title="我的日常生活分享" type="application/atom+xml">
</head>
  </html>
</html>


<body>
  <div id="app">
    
      
      <canvas width="1777" height="841"
        style="position: fixed; left: 0px; top: 0px; z-index: 99999; pointer-events: none;"></canvas>
      
    <main class="content on">
      


<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-object"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/07/17/object/"
    >JS当中的对象</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/07/17/object/" class="article-date">
  <time datetime="2021-07-17T14:01:02.000Z" itemprop="datePublished">2021-07-17</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/javascript/">javascript</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h1><ul>
<li><a href="#object">Object</a><ul>
<li><a href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%89%B9%E5%BE%81">对象的特征</a></li>
<li><a href="#javascript%E4%B8%AD%E5%AF%B9%E8%B1%A1">JavaScript中对象</a><ul>
<li><a href="#%E7%8B%AC%E6%9C%89%E7%9A%84%E7%89%B9%E8%89%B2">独有的特色</a></li>
<li><a href="#%E4%B8%A4%E7%B1%BB%E5%B1%9E%E6%80%A7">两类属性</a><ul>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%B1%9E%E6%80%A7">数据属性</a></li>
<li><a href="#%E8%AE%BF%E9%97%AE%E5%99%A8%E5%B1%9E%E6%80%A7">访问器属性</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%98%E6%98%AF%E5%9F%BA%E4%BA%8E%E5%AF%B9%E8%B1%A1">面向对象还是基于对象</a><ul>
<li><a href="#%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%92%8C%E5%9F%BA%E4%BA%8E%E5%AF%B9%E8%B1%A1">如何定义面向对象和基于对象</a></li>
</ul>
</li>
<li><a href="#%E5%8E%9F%E5%9E%8B">原型</a><ul>
<li><a href="#%E5%8E%9F%E5%9E%8B%E7%B3%BB%E7%BB%9F">原型系统</a></li>
<li><a href="#%E7%B1%BB%E4%B8%8E%E5%8E%9F%E5%9E%8B">类与原型</a><ul>
<li><a href="#new">new</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%AF%B9%E8%B1%A1%E5%88%86%E7%B1%BB">对象分类</a><ul>
<li><a href="#%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1%E5%8E%9F%E7%94%9F%E5%AF%B9%E8%B1%A1">内置对象·原生对象</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="对象的特征"><a href="#对象的特征" class="headerlink" title="对象的特征"></a>对象的特征</h2><ul>
<li><p>对象具有唯一标识性：及时完全相同的两个对象，也并非是同一个对象;（内存地址）</p>
</li>
<li><p>对象有状态：独享具有状态，同意对象可能处于不用状态之下;</p>
</li>
<li><p>对象具有行为：即对象的状态，可能因为他的行为产生变迁；</p>
</li>
</ul>
<h2 id="JavaScript中对象"><a href="#JavaScript中对象" class="headerlink" title="JavaScript中对象"></a>JavaScript中对象</h2><h3 id="独有的特色"><a href="#独有的特色" class="headerlink" title="独有的特色"></a>独有的特色</h3><p>JavaScript 中对象独有的特色是：对象具有高度的动态性，这是因为 JavaScript 赋予了使用者在运行时为对象添改状态和行为的能力。</p>
<p><code>人话：</code>不一定要在声明时确定对象的属性，可以动态添加；</p>
<h3 id="两类属性"><a href="#两类属性" class="headerlink" title="两类属性"></a>两类属性</h3><h4 id="数据属性"><a href="#数据属性" class="headerlink" title="数据属性"></a>数据属性</h4><ul>
<li>value：就是属性的值。</li>
<li>writable：决定属性能否被赋值。</li>
<li>enumerable：决定 for in 能否枚举该属性。</li>
<li>configurable：决定该属性能否被删除或者改变特征值。</li>
</ul>
<h4 id="访问器属性"><a href="#访问器属性" class="headerlink" title="访问器属性"></a>访问器属性</h4><ul>
<li>getter：函数或 undefined，在取属性值时被调用。</li>
<li>setter：函数或 undefined，在设置属性值时被调用。</li>
<li>enumerable：决定 for in 能否枚举该属性。</li>
<li>configurable：决定该属性能否被删除或者改变特征值。</li>
</ul>
<h2 id="面向对象还是基于对象"><a href="#面向对象还是基于对象" class="headerlink" title="面向对象还是基于对象"></a>面向对象还是基于对象</h2><p><code>“JavaScript 不是面向对象”？</code></p>
<p>因为实际上 JavaScript 对象的运行时是一个“属性的集合”，由于 JavaScript 的对象设计跟目前主流基于类的面向对象差异非常大。<br>可事实上，这样的对象系统设计虽然特别，但是 JavaScript 提供了完全运行时的对象系统，这使得它可以模仿多数面向对象编程范式，所以它也是正统的面向对象语言。</p>
<p><code>基于对象？基于类？</code></p>
<p>在不同的编程语言中，设计者也利用各种不同的语言特性来抽象描述对象。最为成功的流派是使用“类”的方式来描述对象，这诞生了诸如 C++、Java 等流行的编程语言。这个流派叫做基于类的编程语言。</p>
<p>“基于类”并非面向对象的唯一形态，如果我们把视线从“类”移开，Brendan 当年选择的原型系统，就是一个非常优秀的抽象对象的形式。</p>
<p>还有一种就是基于原型的编程语言，它们利用原型来描述对象。我们的 JavaScript 就是其中代表。</p>
<h3 id="如何定义面向对象和基于对象"><a href="#如何定义面向对象和基于对象" class="headerlink" title="如何定义面向对象和基于对象"></a>如何定义面向对象和基于对象</h3><ul>
<li>基于对象</li>
</ul>
<p>语言和宿主的基础设施由对象来提供，并且 JavaScript 程序即是一系列互相通讯的对象集合</p>
<ul>
<li>面向对象</li>
</ul>
<h2 id="原型"><a href="#原型" class="headerlink" title="原型"></a>原型</h2><h3 id="原型系统"><a href="#原型系统" class="headerlink" title="原型系统"></a>原型系统</h3><p>原型系统满足两条规则</p>
<ul>
<li>如果所有对象都有私有字段[[prototype]]，就是对象的原型</li>
<li>读一个属性，如果过对象本身没有，则会继续访问对象的原型，知道原型为空或者找到为止；</li>
</ul>
<h3 id="类与原型"><a href="#类与原型" class="headerlink" title="类与原型"></a>类与原型</h3><p>在早期版本的 JavaScript 中，“类”的定义是一个私有属性 [[class]]，语言标准为内置类型诸如 Number、String、Date 等指定了[[class]]属性，以表示它们的类。语言使用者唯一可以访问[[class]]属性的方式是 Object.prototype.toString。</p>
<p><code>在 ES5 开始，[[class]] 私有属性被 Symbol.toStringTag 代替，可被覆盖</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123; [<span class="built_in">Symbol</span>.toStringTag]: <span class="string">&quot;MyObject&quot;</span> &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(o + <span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><code>es6 加入了新类型class</code></p>
<p>ES6 中引入了 class 关键字，并且在标准中删除了所有[[class]]相关的私有属性描述，类的概念正式从属性升级成语言的基础设施。</p>
<h4 id="new"><a href="#new" class="headerlink" title="new"></a>new</h4><p>new运算符实际操作：</p>
<ul>
<li>以构造器的prototype属性为原型，创建新对象；</li>
<li>将this和调用参数传递给构造器，执行；</li>
<li>如果构造器返回对象，则返回，否则返回第一步创建的对象；</li>
</ul>
<p>所以可以这样模拟类：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">c1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.p1 = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">this</span>.p2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.p1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">var</span> o1 = <span class="keyword">new</span> c1;</span><br><span class="line">o1.p2();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">c2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">c2.prototype.p1 = <span class="number">1</span>;</span><br><span class="line">c2.prototype.p2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.p1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o2 = <span class="keyword">new</span> c2;</span><br><span class="line">o2.p2();</span><br></pre></td></tr></table></figure>

<h2 id="对象分类"><a href="#对象分类" class="headerlink" title="对象分类"></a>对象分类</h2><ul>
<li>宿主对象：由 JavaScript 宿主环境提供的对象，它们的行为完全由宿主环境决定。</li>
<li>内置对象：由 JavaScript 语言提供的对象。<ul>
<li>固有对象：由标准规定，随着 JavaScript 运行时创建而自动创建的对象实例。</li>
<li>原生对象：可以由用户通过 Array、RegExp 等内置构造器或者特殊语法创建的对象。</li>
<li>普通对象：由{}语法、Object 构造器或者 class 关键字定义类创建的对象，它能够被原型继承。</li>
</ul>
</li>
</ul>
<h3 id="内置对象·原生对象"><a href="#内置对象·原生对象" class="headerlink" title="内置对象·原生对象"></a>内置对象·原生对象</h3><p><img src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/fe-cdn/native-objects.png" alt="native-objects"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-vue vs react"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/07/17/vue%20vs%20react/"
    >vue vs react</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/07/17/vue%20vs%20react/" class="article-date">
  <time datetime="2021-07-17T14:01:02.000Z" itemprop="datePublished">2021-07-17</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/">前端框架</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="vue-vs-react"><a href="#vue-vs-react" class="headerlink" title="vue vs react"></a>vue vs react</h1><h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><table>
<thead>
<tr>
<th>对比项</th>
<th>vue2</th>
<th>vue3</th>
<th>react15</th>
<th>react16.8+</th>
</tr>
</thead>
<tbody><tr>
<td>api</td>
<td>options</td>
<td>composition</td>
<td>class</td>
<td>hooks</td>
</tr>
</tbody></table>
<h3 id="option优缺点"><a href="#option优缺点" class="headerlink" title="option优缺点"></a>option优缺点</h3><ul>
<li><p>优点</p>
<ul>
<li>便于理解</li>
<li>数据方法划分明显</li>
</ul>
</li>
<li><p>缺点</p>
<ul>
<li>可维护性差，反复横跳</li>
<li>可扩展性差，mixins有命名冲突问题，且以黑盒方式引入，不利于类型推断；</li>
</ul>
</li>
</ul>
<h3 id="composition优缺点"><a href="#composition优缺点" class="headerlink" title="composition优缺点"></a>composition优缺点</h3><ul>
<li>优点<ul>
<li>功能分块，避免反复横跳</li>
<li>对vue可以进行tree shaking</li>
<li>方便组合，组合优于继承</li>
<li>数据流清晰（定义、更新）</li>
<li>render函数只执行一次，后续靠的是响应式通知</li>
</ul>
</li>
</ul>
<ul>
<li>缺点<ul>
<li>难看，较难理解</li>
</ul>
</li>
</ul>
<h3 id="hooks优缺点"><a href="#hooks优缺点" class="headerlink" title="hooks优缺点"></a>hooks优缺点</h3><ul>
<li>优点</li>
</ul>
<ul>
<li>缺点<ul>
<li>render函数每次都会执行，hooks有顺序限制</li>
</ul>
</li>
</ul>
<h2 id="数据流（mutable-vs-immutable）"><a href="#数据流（mutable-vs-immutable）" class="headerlink" title="数据流（mutable vs immutable）"></a>数据流（mutable vs immutable）</h2><p><strong>双向数据流</strong><br>代表：vue<br>可变数据，依赖收集，主动通知来驱动模板</p>
<p><strong>单向数据流</strong><br>代表：react<br>数据不可变，计算数据diff来驱动模板</p>
<h2 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h2><h3 id="jsx"><a href="#jsx" class="headerlink" title="jsx"></a>jsx</h3><p>jsx就是纯js，在react当中会被解析成<code>React.createElement</code></p>
<ul>
<li>优点<ul>
<li>十分自由，js支持的jsx都支持</li>
</ul>
</li>
</ul>
<ul>
<li>缺点<ul>
<li>动态性强，可优化性弱（是我给你自由过了火）;</li>
</ul>
</li>
</ul>
<h3 id="template"><a href="#template" class="headerlink" title="template"></a>template</h3><p>特定语法，解析成<code>creatVNode</code>,变异过程当中会区分动态、静态节点，纯静态节点会跳过diff</p>
<ul>
<li>优点<ul>
<li>有限制，可遍历，可优化性强</li>
<li>形式上更接近html，符合认知</li>
</ul>
</li>
<li>缺点<ul>
<li>不够动态，自由度小，有语法限制（仅能使用限定api）</li>
</ul>
</li>
</ul>
<h2 id="compiler"><a href="#compiler" class="headerlink" title="compiler"></a>compiler</h2><h2 id="vdom"><a href="#vdom" class="headerlink" title="vdom"></a>vdom</h2><p>使用js对象的形式来描述dom结构</p>
<ul>
<li>响应式：数据变更了通知订阅者，主动通知</li>
<li>vdom：不知道数据哪里变了，通过生成新vdom与旧的vdom进行diff才知道变化，被动计算;</li>
</ul>
<h3 id="性能瓶颈"><a href="#性能瓶颈" class="headerlink" title="性能瓶颈"></a>性能瓶颈</h3><ul>
<li>性能跟模板大小正相关，跟动态节点数量无关；</li>
<li></li>
</ul>
<h3 id="vue-vdom-响应式"><a href="#vue-vdom-响应式" class="headerlink" title="vue = vdom + 响应式"></a>vue = vdom + 响应式</h3><p>vue1只有响应式，一旦响应式对象太多，导致卡顿；<br>vue2引入了vdom，使用的是snabbdom的代码，双端预判，较少循环次数；<br>vue3在vue2静态标记的基础上，动态标签内部的静态标签，使用block来标记；</p>
<p><strong>vue怎么区分使用vdom还是使用响应式呢？</strong><br>根据组件划分，组件之间通过响应式通知，组件内部，通过vdom计算diff；</p>
<p>fiber也就是说所谓的时间切片；<br>1、任务可以切开，利用空闲时间计算；<br>2、diff可以中断</p>
<p>原理，把树形结构转化成链表结构</p>
<h3 id="react-纯vdom"><a href="#react-纯vdom" class="headerlink" title="react 纯vdom"></a>react 纯vdom</h3><p>解析jsx，生成createElement，没有太多标记，所以能做的优化很少</p>
<p><strong>vdom杀手锏：</strong></p>
<ul>
<li>性能优化；</li>
<li>跨端；</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react/" rel="tag">react</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vue/" rel="tag">vue</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-动态规划"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/07/17/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"
    >动态规划（Dynamic Programming）</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/07/17/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" class="article-date">
  <time datetime="2021-07-17T14:01:02.000Z" itemprop="datePublished">2021-07-17</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id=""><a href="#" class="headerlink" title=""></a></h1><ul>
<li><a href="#%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92dynamic-programming">动态规划（Dynamic Programming）</a><ul>
<li><a href="#dp%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1">DP算法设计</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0">代码实现</a></li>
<li><a href="#%E5%B8%B8%E8%A7%81%E9%A2%98%E5%9E%8B">常见题型</a><ul>
<li><a href="#%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97longest-common-sequence">最长公共子序列（longest common sequence）</a><ul>
<li><a href="#%E5%88%86%E6%9E%90">分析</a></li>
</ul>
</li>
<li><a href="#%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E4%B8%B2longest-common-substring">最长公共子串（longest common substring）</a></li>
<li><a href="#%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97longest-increase-sequence">最长递增子序列（longest increase sequence）</a><ul>
<li><a href="#%E5%88%86%E6%9E%90-1">分析</a></li>
</ul>
</li>
<li><a href="#%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98">背包问题</a><ul>
<li><a href="#01%E9%97%AE%E9%A2%98">0/1问题</a></li>
<li><a href="#%E6%9C%89%E7%95%8C%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98">有界背包问题</a></li>
<li><a href="#%E6%97%A0%E7%95%8C%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98">无界背包问题</a></li>
</ul>
</li>
<li><a href="#%E6%9C%80%E5%A4%A7%E5%AD%90%E6%95%B0%E5%88%97%E9%97%AE%E9%A2%98">最大子数列问题</a></li>
</ul>
</li>
<li><a href="#reference">reference</a></li>
</ul>
</li>
</ul>
<p>动态规划算法与分治法类似，其基本思想也是将待求解问题分解成若干个子问题，先求解子问题，然后从这些子问题的解得到原问题的解。与分治法不同的是，适合于用动态规划求解的问题，经分解得到子问题往往不是互相独立的。<br>动态规划就是把主问题的所有子问题穷尽求出最优解。</p>
<h2 id="DP算法设计"><a href="#DP算法设计" class="headerlink" title="DP算法设计"></a>DP算法设计</h2><ul>
<li>首先，把当前问题的状态设为x；对于状态x，f(x)为最优解；</li>
<li>找出f(x)与那些状态有关，并写出其他们之间的关联（状态转移方程）</li>
<li></li>
</ul>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 状态<span class="number">1</span> <span class="keyword">in</span> 状态<span class="number">1</span>的所有取值：</span><br><span class="line">    <span class="keyword">for</span> 状态<span class="number">2</span> <span class="keyword">in</span> 状态<span class="number">2</span>的所有取值：</span><br><span class="line">        <span class="keyword">for</span> ...</span><br><span class="line">            dp[状态<span class="number">1</span>][状态<span class="number">2</span>][...] = 择优(选择<span class="number">1</span>，选择<span class="number">2.</span>..)</span><br></pre></td></tr></table></figure>

<h2 id="常见题型"><a href="#常见题型" class="headerlink" title="常见题型"></a>常见题型</h2><h3 id="最长公共子序列（longest-common-sequence）"><a href="#最长公共子序列（longest-common-sequence）" class="headerlink" title="最长公共子序列（longest common sequence）"></a>最长公共子序列（longest common sequence）</h3><p>最长公共子序列（longest common sequence）和最长公共子串（longest common substring）不是一回事儿。什么是子序列呢？即一个给定的序列的子序列，就是将给定序列中零个或多个元素去掉之后得到的结果。什么是子串呢？给定串中任意个连续的字符组成的子序列称为该串的子串。</p>
<h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><ul>
<li>设定：</li>
</ul>
<p>c[i,j]为系列X,Y的最长公共子序列</p>
<ul>
<li>状态转移方程:</li>
</ul>
<p><img src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/fe-cdn/lcs-an.png" alt="lcs"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findLCS</span>(<span class="params">str1, str2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> length1 = str1.length;</span><br><span class="line">    <span class="keyword">const</span> length2 = str2.length;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化结果表</span></span><br><span class="line">    <span class="keyword">const</span> result_arr =  <span class="keyword">new</span> <span class="built_in">Array</span>(length1 + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;= length1;i++) &#123;</span><br><span class="line">        result_arr[i] = [];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">0</span>; j &lt;= length2; j++) &#123;</span><br><span class="line">            result_arr[i][j] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 填表</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">1</span>;i &lt; length1 + <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> x = str1.charAt(i - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">1</span>;j &lt; length2 + <span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">let</span> y = str2.charAt(j - <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(&#123;</span><br><span class="line">                i,j,</span><br><span class="line">                x,y</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">if</span>(x === y) &#123;</span><br><span class="line">                result_arr[i][j] = result_arr[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                result_arr[i][j] = <span class="built_in">Math</span>.max(result_arr[i - <span class="number">1</span>][j],result_arr[i][j - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`i=<span class="subst">$&#123;i&#125;</span>;j=<span class="subst">$&#123;j&#125;</span>; =&gt; <span class="subst">$&#123;result_arr[i][j]&#125;</span>`</span>)</span><br><span class="line">        &#125;       </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result_arr[length1 - <span class="number">1</span>][length2 - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="最长公共子串（longest-common-substring）"><a href="#最长公共子串（longest-common-substring）" class="headerlink" title="最长公共子串（longest common substring）"></a>最长公共子串（longest common substring）</h3><ul>
<li>设定：</li>
</ul>
<p>c[i,j]为字符串X和字符串Y的最长公共子串</p>
<ul>
<li>状态转移方程:</li>
</ul>
<p>当 xi === yi 时，c[i,j] = c[i-1,j-1] + 1;<br>否则c[i,j] = c[i-1,j-1]</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findLCS</span>(<span class="params">str1, str2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> length1 = str1.length;</span><br><span class="line">    <span class="keyword">const</span> length2 = str2.length;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> end = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> maxLength = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化结果表</span></span><br><span class="line">    <span class="keyword">const</span> result_arr =  <span class="keyword">new</span> <span class="built_in">Array</span>(length1 + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;= length1;i++) &#123;</span><br><span class="line">        result_arr[i] = [];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">0</span>; j &lt;= length2; j++) &#123;</span><br><span class="line">            result_arr[i][j] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 填表</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">1</span>;i &lt; length1 + <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> x = str1.charAt(i - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">1</span>;j &lt; length2 + <span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">let</span> y = str2.charAt(j - <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(&#123;</span><br><span class="line">                i,j,</span><br><span class="line">                x,y</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">if</span>(x === y) &#123;</span><br><span class="line">                result_arr[i][j] = result_arr[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(result_arr[i][j] &gt; maxLength) &#123;</span><br><span class="line">                    maxLength = result_arr[i][j];</span><br><span class="line">                    end = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 不连续了，置为0</span></span><br><span class="line">                result_arr[i][j] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`i=<span class="subst">$&#123;i&#125;</span>;j=<span class="subst">$&#123;j&#125;</span>; =&gt; <span class="subst">$&#123;result_arr[i][j]&#125;</span>`</span>)</span><br><span class="line">        &#125;       </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str1.slice(end - maxLength, maxLength)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="最长递增子序列（longest-increase-sequence）"><a href="#最长递增子序列（longest-increase-sequence）" class="headerlink" title="最长递增子序列（longest increase sequence）"></a>最长递增子序列（longest increase sequence）</h3><h4 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h4><ul>
<li>设定：</li>
</ul>
<p>c[i]为字符串X.slice(0,i)的最长递增子序列,f(i)为c[i]的数组长度；</p>
<p>则当x[i] &gt; max(c[i-1])时，c[i] = […c[i-1], x[i]];<br>否则c[i] = c[i-1];</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLIS</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> length = arr.length;</span><br><span class="line">    <span class="keyword">if</span>(arr.length&lt;<span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> arr.length;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> temp = [];</span><br><span class="line">    temp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">1</span>;i&lt;length;i++)&#123;</span><br><span class="line">        temp[i] = temp[i-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">const</span> isBigest = !arr.slice(<span class="number">0</span>,i).some(<span class="function"><span class="params">p</span> =&gt;</span> p &gt; arr[i]);</span><br><span class="line">        <span class="built_in">console</span>.log(&#123;</span><br><span class="line">            <span class="string">&#x27;arr[i-1]&#x27;</span>: arr.slice(<span class="number">0</span>,i),</span><br><span class="line">            <span class="string">&#x27;arr[i]&#x27;</span>: arr[i],</span><br><span class="line">            isBigest</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span>(isBigest)&#123;</span><br><span class="line">            temp[i] += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> temp.pop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="背包问题"><a href="#背包问题" class="headerlink" title="背包问题"></a>背包问题</h3><h4 id="0-1问题"><a href="#0-1问题" class="headerlink" title="0/1问题"></a>0/1问题</h4><p><code>现有n件物品和一个容量为c的背包。第i件物品的重量是重量为w[i]，价值是v[i]。已知对于一件物品必须选择取（用1表示）或者不取（用0表示），且每件物品只能被取一次（这就是“0-1”的含义）。求放置哪些物品进背包，可使这些物品的重量总和不超过背包容量，且价值总和最大。</code></p>
<h4 id="有界背包问题"><a href="#有界背包问题" class="headerlink" title="有界背包问题"></a>有界背包问题</h4><p><code>现有n种物品和一个容量为c的背包。第i件物品的重量是重量为w[i]，价值是v[i]。已知对于一件物品可选数量为（0~c）。求怎样选择物品进背包，可使这些物品的重量总和不超过背包容量，且价值总和最大。</code></p>
<h4 id="无界背包问题"><a href="#无界背包问题" class="headerlink" title="无界背包问题"></a>无界背包问题</h4><p><code>现有n种物品和一个容量为c的背包。第i件物品的重量是重量为w[i]，价值是v[i]。求怎样选择物品进背包，可使这些物品的重量总和不超过背包容量，且价值总和最大。</code></p>
<h3 id="最大子数列问题"><a href="#最大子数列问题" class="headerlink" title="最大子数列问题"></a>最大子数列问题</h3><p>对于数列L，找出L的的子序列，使得：</p>
<p><img src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/fe-cdn/largestSubArray.svg" alt="lagresetSubArr"></p>
<p>如对于数列<code>L = [-2,-3,4,-1,-2,1,5,-3]</code>,其最大子数列为：<code>[4,-1,-2,1,5]</code>,此时<code>M = 4 + (-1) + (-2) + 1 + 5 = 7</code>;</p>
<p><img src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/fe-cdn/largerSubArr-example.png" alt="example"></p>
<h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/23995189">什么是动态规划（Dynamic Programming）？动态规划的意义是什么？</a></li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-微任务与宏任务"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/07/17/%E5%BE%AE%E4%BB%BB%E5%8A%A1%E4%B8%8E%E5%AE%8F%E4%BB%BB%E5%8A%A1/"
    >事件循环，宏任务与微任务</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/07/17/%E5%BE%AE%E4%BB%BB%E5%8A%A1%E4%B8%8E%E5%AE%8F%E4%BB%BB%E5%8A%A1/" class="article-date">
  <time datetime="2021-07-17T14:01:02.000Z" itemprop="datePublished">2021-07-17</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/javascript/">javascript</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="事件循环"><a href="#事件循环" class="headerlink" title="事件循环"></a>事件循环</h1><pre><code>js引擎遇到一个异步事件后并不会一直等待其返回结果，而是会将这个事件挂起，继续执行执行栈中的其他任务。当一个异步事件返回结果后，js会将这个事件加入与当前执行栈不同的另一个队列，我们称之为事件队列。被放入事件队列不会立刻执行其回调，而是等待当前执行栈中的所有任务都执行完毕， 主线程处于闲置状态时，主线程会去查找事件队列是否有任务。如果有，那么主线程会从中取出排在第一位的事件，并把这个事件对应的回调放入执行栈中，然后执行其中的同步代码...，如此反复，这样就形成了一个无限的循环。这就是这个过程被称为“事件循环（Event Loop）”的原因。

在node中，事件循环表现出的状态与浏览器中大致相同。不同的是node中有一套自己的模型。node中事件循环的实现是依靠的libuv引擎。我们知道node选择chrome v8引擎作为js解释器，v8引擎将js代码分析后去调用对应的node api，而这些api最后则由libuv引擎驱动，执行对应的任务，并把不同的事件放在不同的队列中等待主线程执行。 因此实际上node中的事件循环存在于libuv引擎中。
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">宏任务与微任务一直都是面试常见题型，很多时候不仔细分析可能啪叽一下就掉坑了。虽然说实际上那代码一跑就知道啥顺序，但是异步执行的分析咱还是躲不过。</span><br></pre></td></tr></table></figure>

<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>我们把宿主发起的任务称为宏观任务，把 JavaScript 引擎发起的任务称为微观任务。</p>
<p>具体有哪些呢：</p>
<ul>
<li>宏任务<ul>
<li>script(整体代码)</li>
<li>setTimeout</li>
<li>setInterval</li>
<li>I/O</li>
<li>UI交互</li>
<li>postMessage</li>
<li>MessageChannel</li>
<li>setImmediate</li>
<li>……</li>
</ul>
</li>
<li>微任务<ul>
<li>Promise.then</li>
<li>Object.Observe</li>
<li>MutaionObserver</li>
<li>process.nextTick</li>
<li>……</li>
</ul>
</li>
</ul>
<h2 id="运行机制"><a href="#运行机制" class="headerlink" title="运行机制"></a>运行机制</h2><p>在事件循环中，每进行一次循环操作称为 tick，每一次 tick 的任务运行机制大致如下：</p>
<ul>
<li>1.执行一个宏任务；</li>
<li>2.若执行过程中遇到微任务，添加到微任务队列中；</li>
<li>3.宏任务执行完毕，检查并执行当前微任务当中所有任务（依次）；</li>
<li>4.进入下一个宏任务，回到第一步；</li>
</ul>
<p><img src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/fe-cdn/micro_macro_pic.png" alt="pic"></p>
<h2 id="分析实例"><a href="#分析实例" class="headerlink" title="分析实例"></a>分析实例</h2><p>之前学习winter老师的重学前端课程的时候，winter老师在互动区对一道题做了分析解答，这里借鉴一下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;sync1&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;setTimeout1&#x27;</span>)</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;setTimeoutPromise&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;promise&#x27;</span>);</span><br><span class="line">    resolve();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">promise.then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;pro_then&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;pro_timeout&#x27;</span>);</span><br><span class="line">    &#125;, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;last_setTimeout&#x27;</span>)</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;sync2&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>安装运行机制，我们分析如下，这个代码段就是一个宏任务，所以从第一句到最后一局这个代码段是我们的第一个宏任务，我们开始分析如下：</p>
<p><img src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/fe-cdn/micro_macro_1.png" alt="step-1"></p>
<p>第一个宏任务运行下来，总共执行了3次setTimeout，产生了3个宏任务，同时调用了一个Promise.resolve函数，产生了一个微任务，如上图；所以第一次宏任务之后，打印顺序为：<br>sync1、promise、sync2，这时，setTimeout1，setTimeoutPromise，last_setTimeout 在宏任务队列中，pro_then 在微任务队列中。</p>
<p>运行完<code>console.log(&#39;sync2&#39;)</code>之后，第一个宏任务执行完毕，我们检查此时的微任务队列非空，因此执行微任务队列当中的函数，即下图当中的步骤4，即打印出<code>pro_then</code>，然后又调用setTimeout，因此宏任务队列又加入一员。</p>
<p><img src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/fe-cdn/micro_macro_2.png" alt="step-1"></p>
<p>微任务队列执行完，重新从宏任务队列中获取宏任务，因此依次执行5、6、7、8这几个代码，依次打印setTimeout1，setTimeoutPromise，last_setTimeout，pro_timeout。</p>
<h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000020225668">js中的宏任务与微任务</a>;</li>
<li><a target="_blank" rel="noopener" href="https://time.geekbang.org/column/article/88275">重学前端-期中答疑</a>;</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AE%8F%E4%BB%BB%E5%8A%A1/" rel="tag">宏任务</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%82%E6%AD%A5/" rel="tag">异步</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BE%AE%E4%BB%BB%E5%8A%A1/" rel="tag">微任务</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-数据结构"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/07/17/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"
    >数据结构</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/07/17/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="article-date">
  <time datetime="2021-07-17T14:01:02.000Z" itemprop="datePublished">2021-07-17</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h2><p>在计算机科学中, 一个 链表 是数据元素的线性集合, 元素的线性顺序不是由它们在内存中的物理位置给出的。</p>
<h3 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChainNode</span> </span>&#123;</span><br><span class="line">    value = <span class="literal">null</span>;</span><br><span class="line">    next = <span class="literal">null</span>;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">        <span class="built_in">this</span>.next = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个链表</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> chainHeader = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> pre = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">while</span>(i&lt;<span class="number">10</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> node = <span class="keyword">new</span> ChainNode(i);</span><br><span class="line">    <span class="keyword">if</span>(i === <span class="number">0</span>) &#123;</span><br><span class="line">        chainHeader = node;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        pre.next = node;</span><br><span class="line">    &#125;</span><br><span class="line">    pre = node;</span><br><span class="line">    i++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><ul>
<li>插入</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 尾部插入</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">insertIntoTail</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> target = chainHeader;</span><br><span class="line">    <span class="keyword">const</span> insertVal = <span class="number">11</span>;</span><br><span class="line">    <span class="keyword">while</span>(target.next) &#123;</span><br><span class="line">        target = target.next;</span><br><span class="line">    &#125;</span><br><span class="line">    target.next = <span class="keyword">new</span> ChainNode(insertVal);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>搜索</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">find</span>(<span class="params">header , value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> start = header;</span><br><span class="line">    <span class="keyword">while</span>(start) &#123;</span><br><span class="line">        <span class="keyword">if</span>(start.value === value) &#123;</span><br><span class="line">            <span class="keyword">return</span> start;</span><br><span class="line">        &#125;;</span><br><span class="line">        start = start.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>删除</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delByValue</span>(<span class="params">header, value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> current = header;</span><br><span class="line">    <span class="keyword">if</span>(current) &#123;</span><br><span class="line">        <span class="keyword">if</span>(current.value === value) &#123;</span><br><span class="line">            current = delByValue(current.next, value)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            current.next = delByValue(current.next, value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> current;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>遍历</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printNode</span>(<span class="params">header</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(header);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> start = header; start; start = start.next)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(start.value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>反向遍历</li>
<li></li>
</ul>
<h2 id="双向链表"><a href="#双向链表" class="headerlink" title="双向链表"></a>双向链表</h2> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-js手写系列"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/07/17/js%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97/"
    >js手写系列</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/07/17/js%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97/" class="article-date">
  <time datetime="2021-07-17T13:43:07.000Z" itemprop="datePublished">2021-07-17</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PROMISE_STATUS = &#123;</span><br><span class="line">    <span class="attr">FUIFILLED</span>: <span class="string">&#x27;fulfilled&#x27;</span>,</span><br><span class="line">    <span class="attr">REJECTED</span>: <span class="string">&#x27;rejected&#x27;</span>,</span><br><span class="line">    <span class="attr">PENDING</span>: <span class="string">&#x27;pending&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPromise</span> </span>&#123;</span><br><span class="line">    private status = PROMISE_STATUS.PENDING;</span><br><span class="line">    resolveCallbacks = [];</span><br><span class="line">    rejectCallbacks = [];</span><br><span class="line">    value = <span class="literal">null</span>;</span><br><span class="line">    error = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">executor</span>)</span> &#123;</span><br><span class="line">        executor(<span class="built_in">this</span>.resolve, <span class="built_in">this</span>.reject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">resolve</span>(<span class="params">value</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.status === PROMISE_STATUS.PENDING) &#123;</span><br><span class="line">            <span class="built_in">this</span>.status = PROMISE_STATUS.FUIFILLED;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">            <span class="keyword">while</span>(<span class="built_in">this</span>.resolveCallbacks.length) &#123;</span><br><span class="line">                <span class="built_in">this</span>.resolveCallbacks.shift()(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">reject</span>(<span class="params">error</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.status === PROMISE_STATUS.PENDING) &#123;</span><br><span class="line">            <span class="built_in">this</span>.status = PROMISE_STATUS.REJECTED;</span><br><span class="line">            <span class="built_in">this</span>.error = error;</span><br><span class="line">            <span class="keyword">while</span>(<span class="built_in">this</span>.rejectCallbacks.length) &#123;</span><br><span class="line">                <span class="built_in">this</span>.rejectCallbacks.shift()(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">then</span>(<span class="params">onFulfilled, onRejected</span>)</span> &#123;</span><br><span class="line">        <span class="function"><span class="title">swith</span>(<span class="params"><span class="built_in">this</span>.status</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">case</span> PROMISE_STATUS.PENDING:</span><br><span class="line">                onFulfilled &amp;&amp; <span class="built_in">this</span>.resolveCallbacks.push(onFulfilled);</span><br><span class="line">                onRejected &amp;&amp; <span class="built_in">this</span>.rejectCallbacks.push(onRejected);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> PROMISE_STATUS.FUIFILLED:</span><br><span class="line">                onFulfilled(<span class="built_in">this</span>.value);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> PROMISE_STATUS.REJECTED:</span><br><span class="line">                onRejected(<span class="built_in">this</span>.error);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="克隆"><a href="#克隆" class="headerlink" title="克隆"></a>克隆</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Event"><a href="#Event" class="headerlink" title="Event"></a>Event</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="new"><a href="#new" class="headerlink" title="new"></a>new</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createNew</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 1. 创建空对象</span></span><br><span class="line">    <span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line">    <span class="comment">// 2. 链接原型链</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title">constructor</span> = [].<span class="title">shift</span>.<span class="title">call</span>(<span class="params"><span class="built_in">arguments</span></span>);</span><br><span class="line">    obj.__proto__ = <span class="title">constructor</span>.<span class="title">prototype</span>;</span><br><span class="line">    <span class="comment">// 3. 绑定this值</span></span><br><span class="line">    <span class="keyword">const</span> result = <span class="title">constructor</span>.<span class="title">apply</span>(<span class="params">obj, <span class="built_in">arguments</span></span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> result === <span class="string">&#x27;object&#x27;</span> ? result : obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dog</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name || <span class="string">&#x27;jack&#x27;</span>;</span><br><span class="line">    <span class="built_in">this</span>.age = age || <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">this</span>.bark = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;www, i am&#x27;</span>, <span class="built_in">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dog.prototype.hello = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;hello:&#x27;</span>, <span class="built_in">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> jack = createNew(dog, <span class="string">&#x27;mardin&#x27;</span>, <span class="number">22</span>);</span><br><span class="line">jack.bark();</span><br><span class="line">jack.hello();</span><br><span class="line"><span class="built_in">console</span>.log(jack.__proto__ === dog.prototype)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="apply-call-bind"><a href="#apply-call-bind" class="headerlink" title="apply/call/bind"></a>apply/call/bind</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="批量请求"><a href="#批量请求" class="headerlink" title="批量请求"></a>批量请求</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage"></a>localStorage</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a>instanceof</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="ajax"><a href="#ajax" class="headerlink" title="ajax"></a>ajax</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="jsonp"><a href="#jsonp" class="headerlink" title="jsonp"></a>jsonp</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-vite"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/06/17/vite/"
    >vite2.0</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/06/17/vite/" class="article-date">
  <time datetime="2021-06-17T11:55:53.000Z" itemprop="datePublished">2021-06-17</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/">前端框架</a> / <a class="article-category-link" href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/vue/">vue</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="新特性"><a href="#新特性" class="headerlink" title="新特性"></a>新特性</h2><h3 id="插件机制和API"><a href="#插件机制和API" class="headerlink" title="插件机制和API"></a>插件机制和API</h3><h3 id="多框架支持"><a href="#多框架支持" class="headerlink" title="多框架支持"></a>多框架支持</h3><ul>
<li>Vue 3 单文件组件支持：@vitejs/plugin-vue</li>
<li>Vue 3 JSX 支持：@vitejs/plugin-vue-jsx</li>
<li>Vue 2 支持：underfin/vite-plugin-vue2</li>
</ul>
<h3 id="基于esbuild的依赖预打包"><a href="#基于esbuild的依赖预打包" class="headerlink" title="基于esbuild的依赖预打包"></a>基于esbuild的依赖预打包</h3><ul>
<li>原因</li>
</ul>
<p>Vite 以 原生 ESM 方式服务源码。这实际上是让浏览器接管了打包程序的部分工作：Vite 只需要在浏览器请求源码时进行转换并按需提供源码。根据情景动态导入的代码，即只在当前屏幕上实际使用时才会被处理。如下是浏览器支持的导入：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p>如下的裸模块导入：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; a &#125; <span class="keyword">from</span> <span class="string">&#x27;b&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><code>&#39;b&#39;</code> 这个esm模块在浏览器中是无法获取到的，这个包可能是node_modules当中的依赖，而且<code>b</code>模块可能是commomjs/UMD模块，所以首先我们需要将其转化为ESM格式，而且需要将这个导入语法重写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; a &#125; <span class="keyword">from</span> <span class="string">&#x27;/node_modules/.vite/b.js&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>优势</p>
<ul>
<li>预先转化成esm，可利用esm模块的所有优势；</li>
<li>一次转化，终身适用，仅在依赖变更的时候触发重建；</li>
<li>采用强缓存，减少不必要请求（一般情况下依赖包不会变动）</li>
<li>开箱支持ts，预编译阶段将ts编译成js，且速度是<code>tsc</code>的<code>20~30</code>倍开箱即用</li>
</ul>
</li>
<li><p>不足</p>
<ul>
<li>功能不够完善，特别是代码分割和 CSS 处理方面；</li>
<li>对ts只执行转移，不含类型信息，丢失类型推到；</li>
</ul>
</li>
</ul>
<h3 id="更好的css支持"><a href="#更好的css支持" class="headerlink" title="更好的css支持"></a>更好的css支持</h3><ul>
<li>CSS Modules</li>
</ul>
<p>导入 .css 文件将会把内容插入到 <style> 标签中，同时也带有 HMR 支持。<br>任何以 .module.css 为后缀名的 CSS 文件都被认为是一个 CSS modules 文件。导入这样的文件会返回一个相应的模块对象：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* example.module.css */</span></span><br><span class="line"><span class="selector-class">.red</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> classes <span class="keyword">from</span> <span class="string">&#x27;./example.module.css&#x27;</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;foo&#x27;</span>).className = classes.red</span><br></pre></td></tr></table></figure>

<ul>
<li>CSS 预处理器</li>
</ul>
<p>Vite 也提供了对 .scss, .sass, .less, .styl 和 .stylus 文件的内置支持,只需要安装特定的预处理器依赖本身即可获得支持；</p>
<h3 id="ssr支持"><a href="#ssr支持" class="headerlink" title="ssr支持"></a>ssr支持</h3><h3 id="旧浏览器支持"><a href="#旧浏览器支持" class="headerlink" title="旧浏览器支持"></a>旧浏览器支持</h3><p>Vite 默认只支持原生支持 ESM 的现代浏览器，但可以通过官方的 @vitejs/plugin-legacy 来支持旧浏览器。legacy 插件会自动额外生成一个针对旧浏览器的包，并且在 html 中插入根据浏览器 ESM 支持来选择性加载对应包的代码</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vite/" rel="tag">vite</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vue/" rel="tag">vue</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-字符串相关"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/06/12/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E5%85%B3/"
    >KMP算法</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/06/12/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E5%85%B3/" class="article-date">
  <time datetime="2021-06-12T14:01:02.000Z" itemprop="datePublished">2021-06-12</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/javascript/">javascript</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><code>有一个文本串S，和一个模式串P，现在要查找P在S中的位置</code></p>
<ul>
<li>暴力破解</li>
</ul>
<p>假设现在文本串S匹配到 i 位置，模式串P匹配到 j 位置，则有：</p>
<ul>
<li>如果当前字符匹配成功（即S[i] == P[j]），则i++，j++，继续匹配下一个字符；</li>
<li>如果失配（即S[i]! = P[j]），令i = i - (j - 1)，j = 0。相当于每次匹配失败时，i 回溯，j 被置为0。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findSubStr</span>(<span class="params">str, patter</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> str_len = str.length;</span><br><span class="line">    <span class="keyword">const</span> patter_len = patter.length;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span>, j= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; str_len &amp;&amp; j &lt; patter_len) &#123;</span><br><span class="line">        <span class="keyword">if</span>(str[i] === patter[j]) &#123;</span><br><span class="line">            i++;</span><br><span class="line">            j++</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            i = i - j + <span class="number">1</span>;</span><br><span class="line">            j = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(j === patter_len) &#123;</span><br><span class="line">        <span class="keyword">return</span> i - j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>kmp</li>
</ul>
<p><img src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/fe-cdn/kmp.gif" alt="kmp"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findSubStr</span>(<span class="params">str, patter</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> str_len = str.length;</span><br><span class="line">    <span class="keyword">const</span> patter_len = patter.length;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span>, j= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; str_len &amp;&amp; j &lt; patter_len) &#123;</span><br><span class="line">        <span class="keyword">if</span>(str[i] === patter[j]) &#123;</span><br><span class="line">            i++;</span><br><span class="line">            j++</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            j = next(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(j === patter_len) &#123;</span><br><span class="line">        <span class="keyword">return</span> i - j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getNext</span>(<span class="params">patter</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> next = [];</span><br><span class="line">    <span class="keyword">const</span> length = patter.length;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; length)&#123;</span><br><span class="line">        <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(patter.slice(<span class="number">0</span>,index));</span><br><span class="line">        <span class="keyword">while</span>(index &lt; i &amp;&amp; patter[index] === patter[i-index])&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;index&#125;</span>:<span class="subst">$&#123;patter[index]&#125;</span>;<span class="subst">$&#123;i-index&#125;</span>:<span class="subst">$&#123;patter[i-index]&#125;</span>;`</span>)</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">        next[i++] = index;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><a target="_blank" rel="noopener" href="https://www.sohu.com/a/336648975_453160">史上最简(详细)KMP算法讲解，看不懂算我输！ </a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-HTTP"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/05/07/HTTP/"
    >HTTP协议</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/05/07/HTTP/" class="article-date">
  <time datetime="2021-05-07T14:01:02.000Z" itemprop="datePublished">2021-05-07</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/http/">http</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1><h2 id="http协议"><a href="#http协议" class="headerlink" title="http协议"></a>http协议</h2><p><img src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/fe-cdn/http-proto.jpg" alt="http-proto"></p>
<h3 id="method"><a href="#method" class="headerlink" title="method"></a>method</h3><table>
<thead>
<tr>
<th>method</th>
<th>场景</th>
<th>异同</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>GET</td>
<td>地址栏访问</br>ajax请求</td>
<td></td>
<td></td>
</tr>
<tr>
<td>POST</td>
<td>ajax请求</br>表单提交</td>
<td></td>
<td></td>
</tr>
<tr>
<td>HEAD</td>
<td>由js发起</td>
<td>与get类似，但只返回响应头</td>
<td></td>
</tr>
<tr>
<td>PUT</td>
<td>添加资源</td>
<td></td>
<td></td>
</tr>
<tr>
<td>DELETE</td>
<td>删除资源</td>
<td></td>
<td></td>
</tr>
<tr>
<td>CONNECT</td>
<td>用于https/websocket</td>
<td></td>
<td></td>
</tr>
<tr>
<td>OPTIONS</td>
<td>用于调试</td>
<td></td>
<td></td>
</tr>
<tr>
<td>TRACE</td>
<td>用于调试</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="status-and-text"><a href="#status-and-text" class="headerlink" title="status and text"></a>status and text</h3><table>
<thead>
<tr>
<th>status</th>
<th>意义</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>1xx</td>
<td></td>
<td></td>
</tr>
<tr>
<td>200</td>
<td>网页请求成功</td>
<td></td>
</tr>
<tr>
<td>301</td>
<td></td>
<td></td>
</tr>
<tr>
<td>302</td>
<td></td>
<td></td>
</tr>
<tr>
<td>304</td>
<td></td>
<td></td>
</tr>
<tr>
<td>403</td>
<td></td>
<td></td>
</tr>
<tr>
<td>404</td>
<td></td>
<td></td>
</tr>
<tr>
<td>418</td>
<td></td>
<td></td>
</tr>
<tr>
<td>500</td>
<td></td>
<td></td>
</tr>
<tr>
<td>503</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="header"><a href="#header" class="headerlink" title="header"></a>header</h3><p><strong>request header</strong></p>
<table>
<thead>
<tr>
<th>request header</th>
<th>规定</th>
</tr>
</thead>
<tbody><tr>
<td>accept</td>
<td></td>
</tr>
<tr>
<td>accept-encoding</td>
<td></td>
</tr>
<tr>
<td>accept-language</td>
<td></td>
</tr>
<tr>
<td>cache-control</td>
<td></td>
</tr>
<tr>
<td>connection</td>
<td></td>
</tr>
<tr>
<td>host</td>
<td></td>
</tr>
<tr>
<td>if-modified-since</td>
<td></td>
</tr>
<tr>
<td>if-none-match</td>
<td></td>
</tr>
<tr>
<td>user-agent</td>
<td></td>
</tr>
<tr>
<td>cookie</td>
<td></td>
</tr>
</tbody></table>
<p><strong>response header</strong></p>
<table>
<thead>
<tr>
<th>response header</th>
<th>规定</th>
</tr>
</thead>
<tbody><tr>
<td>cache-control</td>
<td></td>
</tr>
<tr>
<td>connection</td>
<td></td>
</tr>
<tr>
<td>content-type</td>
<td></td>
</tr>
<tr>
<td>content-length</td>
<td></td>
</tr>
<tr>
<td>content-language</td>
<td></td>
</tr>
<tr>
<td>date</td>
<td></td>
</tr>
<tr>
<td>etag</td>
<td></td>
</tr>
<tr>
<td>expires</td>
<td></td>
</tr>
<tr>
<td>keep-alive</td>
<td></td>
</tr>
<tr>
<td>last-modified</td>
<td></td>
</tr>
<tr>
<td>server</td>
<td></td>
</tr>
<tr>
<td>set-cookie</td>
<td></td>
</tr>
<tr>
<td>via</td>
<td></td>
</tr>
</tbody></table>
<p><strong>Request Body</strong></p>
<ul>
<li>application/json</li>
<li>application/x-www-form-urlencoded</li>
<li>multipart/form-data</li>
<li>text/xml</li>
</ul>
<h2 id="HTTP1-1"><a href="#HTTP1-1" class="headerlink" title="HTTP1.1"></a>HTTP1.1</h2><ul>
<li><p>长连接</p>
<p>  默认开启长链接，在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟</p>
</li>
<li><p>宽带和网络连接优化</p>
<p>  支持只发送header信息（不带任何body信息），如果服务器认为客户端有权限请求服务器，则返回100，客户端接收到100才开始把请求body发送到服务器</p>
</li>
<li><p>缓存策略</p>
<p>  在HTTP1.0中主要使用header里的If-Modified-Since,Expires来做为缓存判断的标准，HTTP1.1则引入了更多的缓存控制策略例如Entity tag，If-Unmodified-Since, If-Match, If-None-Match等更多可供选择的缓存头来控制缓存策略。</p>
</li>
<li><p>错误状态响应码</p>
<p>  新增了24个错误状态响应码，如409（Conflict）表示请求的资源与资源的当前状态发生冲突；410（Gone）表示服务器上的某个资源被永久性的删除。</p>
</li>
<li><p>Host头处理</p>
<p>  http1.0中默认每台服务器都绑定唯一的一个IP地址,所以请求消息中url并没有传递主机名,也就是hostname.<br>  http1.1中请求消息和响应消息都支持Host头域,而且,如果我们不传这个字段还会报一个400(bad request)的状态码</p>
</li>
</ul>
<h2 id="HTTP-2"><a href="#HTTP-2" class="headerlink" title="HTTP 2"></a><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7540">HTTP 2</a></h2><ul>
<li>多路复用  HTTP/2 中每个请求都被拆分成多个 Frame 通过一条 TCP 连接同时被传输，这样即使一个请求被阻塞，也不会影响其他的请求。同一个连接并发处理多个请求，而且并发请求的数量比HTTP1.1大了好几个数量级。</li>
</ul>
<ul>
<li><p>服务器推送</p>
<p>  允许服务端推送资源给浏览器，在浏览器明确地请求之前，免得客户端再次创建连接发送请求到服务器端获取。这样客户端可以直接从本地加载这些资源，不用再通过网络。</p>
</li>
<li><p>头部压缩</p>
<p>  HTTP1.X时代，状态行和头部却没有经过任何压缩，直接以纯文本传输，导致消耗在头部的流量越来越多。HTTP2.0使用HPACK算法对header的数据进行压缩，这样数据体积小了，在网络上传输就会更快。</p>
</li>
<li><p>二进制流</p>
<p>  将传输信息分割为跟小的信息帧，并对她们进行二进制编码。常见的有header帧、其会开启一个新的流，之后是Data帧，传输正文实体，多个Data帧属于一个流。</p>
</li>
</ul>
<h2 id="HTTP-3"><a href="#HTTP-3" class="headerlink" title="HTTP 3"></a><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/143464334">HTTP 3</a></h2><p>QUIC 是用来替代 TCP、SSL/TLS 的传输层协议，在传输层之上还有应用层，我们熟知的应用层协议有 HTTP、FTP、IMAP 等，这些协议理论上都可以运行在 QUIC 之上，其中运行在 QUIC 之上的 HTTP 协议被称为 HTTP/3，这就是”HTTP over QUIC 即 HTTP/3“的含义。</p>
<ul>
<li><p>零RRT建立链接</p>
<p>  DH 密钥交换算法，DH 算法的核心就是服务端生成 a、g、p 3 个随机数，a 自己持有，g 和 p 要传输给客户端，而客户端会生成 b 这 1 个随机数，通过 DH 算法客户端和服务端可以算出同样的密钥。在这过程中 a 和 b 并不参与网络传输，安全性大大提高。因为 p 和 g 是大数，所以即使在网络中传输的 p、g、A、B 都被劫持，那么靠现在的计算机算力也没法破解密钥。</p>
<p>  QUIC 从请求连接到正式接发 HTTP 数据一共花了 1 RTT，这 1 个 RTT 主要是为了获取 Server Config，后面的连接如果客户端缓存了 Server Config，那么就可以直接发送 HTTP 数据，实现 0 RTT 建立连接。</p>
</li>
<li><p>连接迁移</p>
<p>  TCP 连接基于四元组（源 IP、源端口、目的 IP、目的端口），切换网络时至少会有一个因素发生变化，导致连接发生变化。</p>
<p>  QUIC 的连接不受四元组的影响，当这四个元素发生变化时，原连接依然维持。QUIC 连接不以四元组作为标识，而是使用一个 64 位的随机数，这个随机数被称为 Connection ID，即使 IP 或者端口发生变化，只要 Connection ID 没有变化，那么连接依然可以维持。</p>
</li>
<li><p>队头阻塞/多路复用</p>
<p>  HTTP/1.1 和 HTTP/2 都存在队头阻塞问题（Head of line blocking）：一个 TCP 连接同时传输 10 个请求，其中第 1、2、3 个请求已被客户端接收，但第 4 个请求丢失，那么后面第 5 - 10 个请求都被阻塞，需要等第 4 个请求处理完毕才能被处理，这样就浪费了带宽资源。</p>
<p>  HTTP/2 的每个请求都会被拆分成多个 Frame，不同请求的 Frame 组合成 Stream，Stream 是 TCP 上的逻辑传输单元，在一条 TCP 连接上同时发送 4 个 Stream，其中 Stream1 已正确送达，Stream2 中的第 3 个 Frame 丢失，TCP 处理数据时有严格的前后顺序，先发送的 Frame 要先被处理，这样就会要求发送方重新发送第 3 个 Frame，Stream3 和 Stream4 虽然已到达但却不能被处理，那么这时整条连接都被阻塞。</p>
<p>  QUIC 的传输单元是 Packet，加密单元也是 Packet，整个加密、传输、解密都基于 Packet，这样就能避免 TLS 的队头阻塞问题；<br>  QUIC 基于 UDP，UDP 的数据包在接收端没有处理顺序，即使中间丢失一个包，也不会阻塞整条连接，其他的资源会被正常处理。</p>
</li>
</ul>
<h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2818">HTTPS</a></h2><p>HTTPS 有两个作用，一是确定请求的目标服务端身份，二是保证传输的数据不会被网络中间节点窃听或者篡改。</p>
<ul>
<li><p>保密性–对称加密、非对称加密</p>
<p>  我们说http是明文传输，所以https首要解决的问题就是它的通信加密，达到保密性。首先客户端请求服务端，服务端将自己的公钥返回，客户端拿到公钥后就可以用它来加密要传输的数据data ，将加密数据secret data发送到服务端后通过服务端的私钥来解密，以此完成加密传输。</p>
<p>  有了非对称加密，只要我们将其中的data换成随机码key，这个key作为对称加密中密钥。密钥传输问题就解决了，同时很好地利用了对称加密的高效率。</p>
</li>
<li><p>真实性、准确性–数字证书、签名</p>
<p>所谓证书就是第三方（自签证书没有公证效应）颁发的认证，在HTTPS中存在一种认证机构即CA（Certification Authority），由它来证明你所连接的服务端就是你想要连接的server，即保证服务端真实性。</p>
</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/http/" rel="tag">http</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/" rel="tag">浏览器</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-词法-语法"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/04/17/%E8%AF%8D%E6%B3%95-%E8%AF%AD%E6%B3%95/"
    >Javascript的执行</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/04/17/%E8%AF%8D%E6%B3%95-%E8%AF%AD%E6%B3%95/" class="article-date">
  <time datetime="2021-04-17T21:01:02.000Z" itemprop="datePublished">2021-04-18</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/javascript/">javascript</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id=""><a href="#" class="headerlink" title=""></a></h2><ul>
<li><a href="#javascript%E7%9A%84%E6%89%A7%E8%A1%8C">Javascript的执行</a><ul>
<li><a href="#%E5%AE%8F%E8%A7%82%E4%BB%BB%E5%8A%A1%E5%BE%AE%E8%A7%82%E4%BB%BB%E5%8A%A1">宏观任务、微观任务</a></li>
<li><a href="#%E9%97%AD%E5%8C%85%E4%B8%8E%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87">闭包与执行上下文</a></li>
</ul>
</li>
<li><a href="#%E8%AF%AD%E5%8F%A5">语句</a><ul>
<li><a href="#completion-record">Completion Record</a><ul>
<li><a href="#%E6%99%AE%E9%80%9A%E8%AF%AD%E5%8F%A5">普通语句</a></li>
<li><a href="#%E8%AF%AD%E5%8F%A5%E5%9D%97">语句块</a></li>
<li><a href="#%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5">控制语句</a></li>
<li><a href="#%E5%B8%A6%E6%A0%87%E7%AD%BE%E7%9A%84%E8%AF%AD%E5%8F%A5">带标签的语句</a></li>
</ul>
</li>
<li><a href="#%E5%85%A8%E5%B1%80%E6%9C%BA%E5%88%B6">全局机制</a><ul>
<li><a href="#%E9%A2%84%E5%A4%84%E7%90%86">预处理</a></li>
<li><a href="#%E6%8C%87%E4%BB%A4%E5%BA%8F%E8%A8%80">指令序言</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>一个 JavaScript 引擎会常驻于内存中，它等待着我们（宿主）把 JavaScript 代码或者函数传递给它执行。</p>
<p>JavaScript 引擎等待宿主环境分配宏观任务，在操作系统中，通常等待的行为都是一个事件循环，所以在 Node 术语中，也会把这个部分称为事件循环。</p>
<p>这里每次的执行过程，其实都是一个宏观任务。我们可以大概理解：宏观任务的队列就相当于事件循环。</p>
<p>在宏观任务中，JavaScript 的 Promise 还会产生异步代码，JavaScript 必须保证这些异步代码在一个宏观任务中完成，因此，每个宏观任务中又包含了一个微观任务队列</p>
<h3 id="宏观任务、微观任务"><a href="#宏观任务、微观任务" class="headerlink" title="宏观任务、微观任务"></a>宏观任务、微观任务</h3><p>我们把宿主发起的任务称为宏观任务，把 JavaScript 引擎发起的任务称为微观任务。</p>
<p>分析异步执行的顺序：</p>
<ul>
<li>首先分析有多少个宏任务；</li>
<li>在每个宏任务中，分析有多少个微任务；</li>
<li>根据调用次序，确定宏任务中微任务的执行次序；</li>
<li>根据宏任务的触发规则和调用次序，确定宏任务的执行次序；</li>
<li>确定整个顺序；</li>
</ul>
<p>这里有个详细分析的<a href="./%E5%BE%AE%E4%BB%BB%E5%8A%A1%E4%B8%8E%E5%AE%8F%E4%BB%BB%E5%8A%A1.md">例子</a>，可以帮助理解这个执行顺序；</p>
<h3 id="闭包与执行上下文"><a href="#闭包与执行上下文" class="headerlink" title="闭包与执行上下文"></a>闭包与执行上下文</h3><p><code>执行上下文</code></p>
<p>JavaScript 标准把一段代码（包括函数），执行所需的所有信息定义为：“执行上下文”。</p>
<p><code>闭包</code></p>
<p>当函数能够记住并访问其所在词法作用域时，便形成了闭包；</p>
<h2 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h2><p><img src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/fe-cdn/yuju.jpg" alt="yuju"></p>
<h3 id="Completion-Record"><a href="#Completion-Record" class="headerlink" title="Completion Record"></a>Completion Record</h3><p>Completion Record 表示一个语句执行完之后的结果，JavaScript 正是依靠语句的 Completion Record 类型，方才可以在语句的复杂嵌套结构中，实现各种控制。接下来我们要来了解一下 JavaScript 使用 Completion Record 类型，控制语句执行的过程。它有三个字段：</p>
<ul>
<li><code>[[type]] 表示完成的类型，有 break continue return throw 和 normal 几种类型；</code></li>
<li><code>[[value]] 表示语句的返回值，如果语句没有，则是 empty；</code></li>
<li><code>[[target]] 表示语句的目标，通常是一个 JavaScript 标签（标签在后文会有介绍）。</code></li>
</ul>
<h4 id="普通语句"><a href="#普通语句" class="headerlink" title="普通语句"></a>普通语句</h4><p>普通语句执行后，会得到 [[type]] 为 normal 的 Completion Record，JavaScript 引擎遇到这样的 Completion Record，会继续执行下一条语句。</p>
<h4 id="语句块"><a href="#语句块" class="headerlink" title="语句块"></a>语句块</h4><p>语句块本身并不复杂，我们需要注意的是语句块内部的语句的 Completion Record 的[[type]] 如果不为 normal，会打断语句块后续的语句执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> i = <span class="number">1</span>; <span class="comment">// normal, empty, empty</span></span><br><span class="line">  <span class="keyword">return</span> i; <span class="comment">// return, 1, empty</span></span><br><span class="line">  i ++; </span><br><span class="line">  <span class="built_in">console</span>.log(i)</span><br><span class="line">&#125; <span class="comment">// return, 1, empty</span></span><br></pre></td></tr></table></figure>

<h4 id="控制语句"><a href="#控制语句" class="headerlink" title="控制语句"></a>控制语句</h4><p><img src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/fe-cdn/control.png" alt="control"></p>
<h4 id="带标签的语句"><a href="#带标签的语句" class="headerlink" title="带标签的语句"></a>带标签的语句</h4><p>唯一有作用的时候是：与完成记录类型中的 target 相配合，用于跳出多层循环。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">outer</span>: <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="attr">inner</span>: <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">      <span class="keyword">break</span> outer;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;finished&quot;</span>)****</span><br></pre></td></tr></table></figure>

<h3 id="全局机制"><a href="#全局机制" class="headerlink" title="全局机制"></a>全局机制</h3><p>JavaScript 语法的全局机制：预处理和指令序言。</p>
<h4 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h4><p>JavaScript 执行前，会对脚本、模块和函数体中的语句进行预处理。预处理过程将会提前处理 var、函数声明、class、const 和 let 这些语句，以确定其中变量的意义。</p>
<pre><code>变量的生命周期：
1. 声明阶段：在作用域中注册一个变量；
2. 初始化阶段：分配内存，并在作用域中让内存与变量建立了绑定，变量初始化为undefined
3. 赋值阶段：代码执行，为初始变量分配一个具体值；
</code></pre>
<ul>
<li><strong>var声明</strong></li>
</ul>
<p>var 声明永远作用于脚本、模块和函数体这个级别，在预处理阶段，不关心赋值的部分，只管在当前作用域声明这个变量。</p>
<p><strong>声明、初始化阶段耦合，且提升至作用域顶部</strong></p>
<ul>
<li><strong>函数声明</strong></li>
</ul>
<p>在全局（脚本、模块和函数体），function 声明表现跟 var 相似，不同之处在于，function 声明不但在作用域中加入变量，还会给它赋值。即：</p>
<p><strong>声明、初始化、赋值阶段耦合，且提升至作用域顶部</strong></p>
<p>function 声明出现在 if 等语句中的情况有点复杂，它仍然作用于脚本、模块和函数体级别，在预处理阶段，仍然会产生变量，它不再被提前赋值：</p>
<p><strong>声明、初始化阶段耦合，且提升至作用域顶部，但赋值阶段无法穿透控制语句</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(foo); <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>class</strong></li>
</ul>
<p>在 class 声明之前使用 class 名，会抛错；<br><strong>声明阶段提升至作用域顶部，let、const也是如此</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(test); <span class="comment">// undefined</span></span><br><span class="line">    <span class="keyword">var</span> test =<span class="number">7</span>;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(test); <span class="comment">// Error： : Cannot access &#x27;test&#x27; before initialization</span></span><br><span class="line">    <span class="keyword">let</span> test =<span class="number">7</span>;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(test); <span class="comment">// Error： : Cannot access &#x27;test&#x27; before initialization</span></span><br><span class="line">    <span class="keyword">const</span> test =<span class="number">7</span>;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(test); <span class="comment">// Error： : Cannot access &#x27;test&#x27; before initialization</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;&#125;;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(test); </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">test</span> </span>&#123;&#125;; <span class="comment">// f test()&#123;&#125;</span></span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(test); <span class="comment">// undefined</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">false</span>) <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure>

<h4 id="指令序言"><a href="#指令序言" class="headerlink" title="指令序言"></a>指令序言</h4><p>指令序言最早是为了 use strict 设计的，它规定了一种给 JavaScript 代码添加元信息的方式。</p>
<p>JavaScript 的指令序言是只有一个字符串直接量的表达式语句，它只能出现在脚本、模块和函数体的最前面。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AF%8D%E6%B3%95%E8%AF%AD%E6%B3%95/" rel="tag">词法语法</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/">上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2022
        <i class="ri-heart-fill heart_icon"></i> hustchenshu
      </li>
    </ul>
    <ul>
      <li>
        
        
        
        由 <a href="https://hexo.io" target="_blank">Hexo</a> 强力驱动
        <span class="division">|</span>
        主题 - <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
        <li>
          <a href="https://beian.miit.gov.cn/" target="_black" rel="nofollow">鄂ICP备17017286号-2</a>
        </li>
        
    </ul>
    <ul>
      
      <li>
          <img src="/images/beian.png"></img>
          <a href="https://beian.miit.gov.cn/#/Integrated/recordQuery" target="_black" rel="nofollow">30159204181516625</a>
      </li>
        
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/cdn/fav.png" alt="我的日常生活分享"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">友链</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/guide">导航</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://github.com/hustchenshu">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/ali_pay.jpeg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://booker-17dbbd-1252444055.tcloudbaseapp.com/cdn/wechat_pay.jpeg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->
 
<script src="/js/clickBoom2.js"></script>
 
<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->
 
<script src="/js/dz.js"></script>
 
<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":true,"model":{"jsonPath":"live2d-widget-model-wanko"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>

</html>